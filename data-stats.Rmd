---
title: "data_stats"
author: "Isabella Lin and Sydney Gu"
date: "2025-03-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, warning=FALSE}
library(dplyr)
library(tidyr)
library(haven)
library(glmnet)
library(data.table)
library(knitr)
```

```{r}
purl("cleaning.Rmd", output = "cleaning2.R")
source("cleaning2.R")
```

Remove observations with NAs:
```{r}
cex <- na.omit(cex)
psid2 <- na.omit(psid)
dim(psid)
dim(psid2)
```

Calculate summary statistics:
```{r}
# CEX
agec <- summary(cex$age)
agecv <- var(cex$age)
famc <- summary(cex$fsize)
famcv <- var(cex$fsize)
yoec <- summary(cex$educ)
yoecv <- var(cex$educ)
incc <- summary(cex$income)
inccv <- var(cex$income)
foodc <- summary(cex$food)
foodcv <- var(cex$food)

# PSID
agep <- summary(psid$age)
agepv <- var(psid$age)
famp <- summary(psid$fsize)
fampv <- var(psid$fsize)
yoep <- summary(psid$educ)
yoepv <- var(psid$educ, na.rm=TRUE)
incp <- summary(psid$income)
incpv <- var(psid$income)
foodp <- summary(psid$food)
foodpv <- var(psid$food)
```

Format into table:
```{r}
data_stats <- data.frame(
  Variable = c("Age", "Family Size", "Years of Education", "Income", "Food Expenditure"),
  Mean = round(c(agec[4], famc[4], yoec[4], incc[4], foodc[4]), 2),
  Median = round(c(agec[3], famc[3], yoec[3], incc[3], foodc[3]), 2),
  Min. = round(c(agec[1], famc[1], yoec[1], incc[1], foodc[1]), 2),
  Max. = round(c(agec[5], famc[5], yoec[5], incc[5], foodc[5]), 2),
  Variance = format(c(agecv, famcv, yoecv, inccv, foodcv), scientific=TRUE, digits=2),
  Mean = round(c(agep[4], famp[4], yoep[4], incp[4], foodp[4]), 2),
  Median = round(c(agep[3], famp[3], yoep[3], incp[3], foodp[3]), 2),
  Min. = round(c(agep[1], famp[1], yoep[1], incp[1], foodp[1]), 2),
  Max. = round(c(agep[5], famp[5], yoep[5], incp[5], foodp[5]), 2),
  Variance = format(c(agepv, fampv, yoepv, incpv, foodpv), scientific=TRUE, digits=2), 
  check.names = FALSE
)
kable(data_stats, caption = "Comparison of Summary Statistics in CEX and PSID") %>%
  kable_styling("striped") %>%
  add_header_above(c(" " = 1, "CEX" = 5, "PSID" = 5)) %>%
  row_spec(0, bold = TRUE)

```